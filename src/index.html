<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scribe</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Homepage (main landing page) -->
    <div id="homepage-screen" class="container hidden">
        <div class="homepage-wrapper">
            <div class="homepage-header">
                <h1 class="homepage-title">Scribe</h1>
                <p class="homepage-subtitle">Voice to text, offline and private</p>
            </div>

            <div class="homepage-status" id="homepage-status">
                <span class="status-dot status-loaded" id="homepage-status-dot"></span>
                <span id="homepage-status-text">Loading...</span>
            </div>

            <div class="homepage-actions">
                <button id="homepage-dictate-btn" class="btn btn-homepage-primary" disabled>
                    Start Dictating
                </button>
                <button id="homepage-upload-btn" class="btn btn-homepage-secondary" disabled>
                    Upload File
                    <span class="coming-soon-badge">Coming Soon</span>
                </button>
            </div>

            <div class="homepage-nav">
                <button id="homepage-settings-btn" class="btn btn-homepage-nav">Settings</button>
                <button id="homepage-history-btn" class="btn btn-homepage-nav">History</button>
            </div>
        </div>
    </div>

    <!-- Onboarding wizard (first-run only) -->
    <div id="onboarding-screen" class="container hidden">
        <div class="onboarding-wrapper">
            <!-- Skip link (top-right corner) -->
            <button id="onboarding-skip" class="onboarding-skip">Skip</button>

            <!-- Step indicator dots -->
            <div class="onboarding-steps">
                <span class="step-dot step-active" data-step="1"></span>
                <span class="step-dot" data-step="2"></span>
                <span class="step-dot" data-step="3"></span>
                <span class="step-dot" data-step="4"></span>
            </div>

            <!-- Step 1: Welcome -->
            <div id="onboarding-step-1" class="onboarding-step">
                <h1 class="onboarding-title">Welcome to Scribe</h1>
                <p class="onboarding-subtitle">Turn your voice into text. 100% offline, 100% free.</p>
                <div class="onboarding-features">
                    <div class="onboarding-feature-card">
                        <span class="feature-icon">&#128274;</span>
                        <div>
                            <strong>Private by design</strong>
                            <p>Your voice never leaves your device. No cloud, no accounts.</p>
                        </div>
                    </div>
                    <div class="onboarding-feature-card">
                        <span class="feature-icon">&#9889;</span>
                        <div>
                            <strong>Works everywhere</strong>
                            <p>Dictate into any app. Email, chat, documents, code editors.</p>
                        </div>
                    </div>
                    <div class="onboarding-feature-card">
                        <span class="feature-icon">&#127760;</span>
                        <div>
                            <strong>No internet needed</strong>
                            <p>Runs entirely on your computer. Works offline, always.</p>
                        </div>
                    </div>
                </div>
                <button id="onboarding-get-started" class="btn btn-onboarding-primary">Get Started</button>
            </div>

            <!-- Step 2: Download Model -->
            <div id="onboarding-step-2" class="onboarding-step hidden">
                <h1 class="onboarding-title">Download Speech Model</h1>
                <p class="onboarding-subtitle">Scribe needs a small AI model to recognize your voice. We recommend <strong>Base English</strong> for the best balance of speed and accuracy.</p>
                <div class="onboarding-model-card">
                    <div class="onboarding-model-header">
                        <span class="onboarding-model-name">Base English</span>
                        <span class="onboarding-model-size">148 MB</span>
                    </div>
                    <p class="onboarding-model-desc">Fast recognition, optimized for English. Perfect for getting started.</p>
                </div>
                <div id="onboarding-download-area">
                    <button id="onboarding-download-btn" class="btn btn-onboarding-primary">Download Model</button>
                </div>
                <div id="onboarding-download-progress" class="hidden">
                    <div class="progress-bar-container">
                        <div id="onboarding-progress-bar" class="progress-bar-fill"></div>
                    </div>
                    <p id="onboarding-download-status" class="onboarding-progress-status">Starting download...</p>
                </div>
                <div id="onboarding-download-done" class="hidden">
                    <p class="onboarding-success-text">&#10003; Model downloaded and loaded!</p>
                </div>
            </div>

            <!-- Step 3: Try It! -->
            <div id="onboarding-step-3" class="onboarding-step hidden">
                <h1 class="onboarding-title">Try It!</h1>
                <p class="onboarding-subtitle">Let's make sure everything works. Press your hotkey and say something.</p>
                <div class="onboarding-hotkey-prompt">
                    <p>Your hotkey is</p>
                    <div id="onboarding-hotkey-display" class="hotkey-display onboarding-hotkey-keys"></div>
                </div>
                <div class="onboarding-test-prompt">
                    <p>Press <span id="onboarding-hotkey-inline" class="onboarding-hotkey-inline-text">your hotkey</span> and say:</p>
                    <p class="onboarding-dictation-phrase">"Hello, Scribe"</p>
                </div>
                <div id="onboarding-test-result" class="onboarding-test-result hidden">
                    <div id="onboarding-test-success" class="hidden">
                        <p class="onboarding-result-label">You said:</p>
                        <p id="onboarding-result-text" class="onboarding-result-text"></p>
                        <p class="onboarding-success-text">&#10003; It works!</p>
                    </div>
                    <div id="onboarding-test-fail" class="hidden">
                        <p class="onboarding-fail-text">No speech detected. Make sure your microphone is working and try again.</p>
                        <button id="onboarding-try-again-btn" class="btn btn-switch">Try Again</button>
                    </div>
                </div>
                <div id="onboarding-test-listening" class="onboarding-test-listening hidden">
                    <div class="onboarding-listening-indicator">
                        <span class="onboarding-listening-dot"></span>
                        <span>Listening...</span>
                    </div>
                    <div class="onboarding-vu-meter">
                        <div id="onboarding-vu-bar" class="onboarding-vu-bar-fill"></div>
                    </div>
                </div>
                <button id="onboarding-continue-btn" class="btn btn-onboarding-primary hidden">Continue</button>
            </div>

            <!-- Step 4: Done! -->
            <div id="onboarding-step-4" class="onboarding-step hidden">
                <h1 class="onboarding-title">You're All Set!</h1>
                <p class="onboarding-subtitle">Scribe is ready to go.</p>
                <div class="onboarding-tips">
                    <div class="onboarding-tip">
                        <strong>System Tray</strong>
                        <p>Scribe lives in your system tray (bottom-right). It's always ready.</p>
                    </div>
                    <div class="onboarding-tip">
                        <strong>Dictate Anywhere</strong>
                        <p>Press <span id="onboarding-final-hotkey" class="onboarding-hotkey-inline-text">your hotkey</span> in any app to start dictating. Press again to stop.</p>
                    </div>
                    <div class="onboarding-tip">
                        <strong>Escape to Cancel</strong>
                        <p>Changed your mind? Press Escape while recording to cancel.</p>
                    </div>
                </div>
                <div class="onboarding-final-actions">
                    <button id="onboarding-open-settings" class="btn btn-onboarding-primary">Get Started</button>
                    <button id="onboarding-close" class="btn btn-switch">Close to Tray</button>
                </div>
            </div>
        </div>
    </div>

    <!-- First-run setup screen -->
    <div id="setup-screen" class="container hidden">
        <div class="setup-wrapper">
            <h1>Setting up Scribe</h1>
            <p class="setup-subtitle">Downloading speech model (<span id="setup-model-size">142</span>MB)...</p>
            <div class="progress-bar-container">
                <div id="setup-progress-bar" class="progress-bar-fill"></div>
            </div>
            <p id="setup-status" class="setup-status">Connecting to service...</p>
        </div>
    </div>

    <!-- Normal settings screen -->
    <div id="settings-screen" class="container hidden">
        <div class="back-nav">
            <button id="back-to-home" class="btn btn-back">&larr; Home</button>
        </div>
        <!-- Tab navigation -->
        <div class="tab-bar">
            <button id="tab-settings" class="tab-btn tab-active" data-tab="settings">Settings</button>
            <button id="tab-history" class="tab-btn" data-tab="history">History</button>
        </div>

        <!-- Settings tab content -->
        <div id="panel-settings" class="tab-panel">
            <!-- Active model section -->
            <section class="settings-section">
                <h2>Current Model</h2>
                <div id="active-model-card" class="model-card active-model-card">
                    <div class="model-card-header">
                        <span class="status-dot status-loaded"></span>
                        <span id="active-model-name" class="model-name">--</span>
                    </div>
                    <span id="active-model-desc" class="model-description">--</span>
                </div>
            </section>

            <!-- Hotkey section -->
            <section class="settings-section" id="hotkey-section">
                <h2>Hotkey</h2>

                <!-- Display mode: shows current hotkey -->
                <div id="hotkey-display-mode">
                    <div class="hotkey-display" id="hotkey-display">
                        <!-- Populated dynamically by JS -->
                    </div>
                    <button id="hotkey-change-btn" class="btn btn-switch">Change</button>
                </div>

                <!-- Capture mode: listening for key press -->
                <div id="hotkey-capture-mode" class="hidden">
                    <div class="hotkey-capture-box" id="hotkey-capture-box">
                        <span class="hotkey-capture-prompt">Press your desired key combination...</span>
                    </div>
                    <div class="hotkey-capture-preview hidden" id="hotkey-capture-preview">
                        <!-- Filled with <kbd> elements by JS -->
                    </div>
                    <div id="hotkey-capture-error" class="hotkey-capture-error hidden"></div>
                    <div class="hotkey-capture-actions">
                        <button id="hotkey-save-btn" class="btn btn-download hidden">Save</button>
                        <button id="hotkey-cancel-btn" class="btn btn-switch">Cancel</button>
                    </div>
                </div>

                <p class="hotkey-hint">Press to start recording. Press again to stop and transcribe. Escape to cancel.</p>
            </section>

            <!-- Language section -->
            <section class="settings-section">
                <h2>Language</h2>
                <select id="language-select" class="settings-select">
                    <option value="auto">Auto-detect</option>
                    <option value="en">English</option>
                    <option value="es">Spanish</option>
                    <option value="fr">French</option>
                    <option value="de">German</option>
                    <option value="pt">Portuguese</option>
                    <option value="it">Italian</option>
                    <option value="nl">Dutch</option>
                    <option value="ja">Japanese</option>
                    <option value="ko">Korean</option>
                    <option value="zh">Chinese</option>
                    <option value="ru">Russian</option>
                    <option value="ar">Arabic</option>
                    <option value="hi">Hindi</option>
                </select>
                <p class="settings-hint">Select "Auto-detect" to let Whisper identify the language automatically.</p>
            </section>

            <!-- Output mode section -->
            <section class="settings-section">
                <h2>Output Mode</h2>
                <select id="output-mode-select" class="settings-select">
                    <option value="clipboard_paste">Clipboard + Auto-paste (Ctrl+V)</option>
                    <option value="clipboard_only">Copy to clipboard only</option>
                    <option value="direct_type">Direct typing (slower, more compatible)</option>
                </select>
                <p class="settings-hint">How transcribed text is inserted into your active application.</p>
            </section>

            <!-- Text cleanup section -->
            <section class="settings-section">
                <h2>Text Cleanup</h2>
                <div class="toggle-row">
                    <label class="toggle-label" for="filler-removal-toggle">
                        Remove filler words
                    </label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="filler-removal-toggle" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                <p class="settings-hint">Removes "um," "uh," "like" (as filler), "you know," and similar words from transcriptions. Disable for verbatim output.</p>
            </section>

            <!-- Sound effects section -->
            <section class="settings-section">
                <h2>Sound Effects</h2>
                <div class="toggle-row">
                    <label class="toggle-label" for="sound-effects-toggle">
                        Play audio cues on start/stop
                    </label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="sound-effects-toggle" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                <p class="settings-hint">Short tones confirm recording state changes, even when you're not looking at the screen. Disable for silent operation.</p>
            </section>

            <!-- Auto-start section -->
            <section class="settings-section">
                <h2>Startup</h2>
                <div class="toggle-row">
                    <label class="toggle-label" for="auto-start-toggle">
                        Launch Scribe when Windows starts
                    </label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="auto-start-toggle">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                <p class="settings-hint">Scribe will start minimized in the system tray, ready for voice input.</p>
            </section>

            <!-- Available models section -->
            <section class="settings-section">
                <h2>Available Models</h2>
                <div id="model-list" class="model-list">
                    <!-- Populated by JS -->
                </div>
            </section>
        </div>

        <!-- History tab content -->
        <div id="panel-history" class="tab-panel hidden">
            <div class="history-search-container">
                <input type="text" id="history-search" class="history-search-input"
                       placeholder="Search transcriptions..." autocomplete="off" spellcheck="false">
                <button id="history-search-clear" class="history-search-clear hidden" aria-label="Clear search">&times;</button>
                <span id="history-result-count" class="history-result-count hidden"></span>
            </div>
            <div id="history-list" class="history-list">
                <!-- Populated by JS -->
            </div>
            <div id="history-empty" class="history-empty hidden">
                <p>No transcriptions yet.</p>
                <p class="settings-hint">Press <span id="history-hotkey-hint">Ctrl+Shift+Space</span> to start recording.</p>
            </div>
            <div class="history-actions">
                <button id="clear-history-btn" class="btn btn-danger">Clear All History</button>
            </div>
        </div>
    </div>

    <!-- Connection error overlay -->
    <div id="error-overlay" class="container hidden">
        <div class="setup-wrapper">
            <h1>Scribe</h1>
            <p class="error-message">Could not reach the Scribe service.</p>
            <p class="setup-status">Retrying...</p>
        </div>
    </div>

    <script src="main.js" type="module"></script>
</body>
</html>
