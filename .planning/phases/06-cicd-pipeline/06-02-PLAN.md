---
phase: 06-cicd-pipeline
plan: 02
type: execute
wave: 2
depends_on: ["06-01"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Pushing a test tag triggers the workflow on GitHub Actions"
    - "Workflow completes successfully (green check)"
    - "GitHub Release exists with NSIS installer attached"
    - "SHA256SUMS.txt is attached to the release"
    - "Release notes are auto-generated from commits"
    - "Installer filename is correct (Scribe-setup.exe or similar)"
  artifacts: []
  key_links:
    - from: "git tag v1.1.0"
      to: "GitHub Actions workflow run"
      via: "tag push trigger"
      pattern: "v[0-9]+\\.[0-9]+\\.[0-9]+"
    - from: "GitHub Actions workflow"
      to: "GitHub Releases page"
      via: "tauri-action release creation"
      pattern: "releases/tag/v"
---

<objective>
Verify the CI/CD pipeline works end-to-end by pushing a test tag and confirming the full release flow.

Purpose: The workflow file was created in Plan 01, but CI/CD pipelines can only be validated by actually running them. This plan pushes a real tag and verifies every step succeeds on the GitHub Actions runner.

Output: Confirmed working pipeline, first GitHub Release created.
</objective>

<execution_context>
@C:\Users\bhara\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\bhara\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-cicd-pipeline/06-01-SUMMARY.md
@.github/workflows/release.yml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Commit workflow and config changes, push to remote</name>
  <files></files>
  <action>
  Ensure all changes from Plan 01 are committed and pushed to the remote repository:

  1. Check git status for uncommitted changes in `.github/workflows/release.yml` and `src-tauri/tauri.conf.json`.
  2. If not already committed, stage and commit with message: `ci: add GitHub Actions release workflow`
  3. Push the commit to the `main` (or `master`) branch on the remote.
  4. Verify the push succeeded with `git log --oneline -1` and `git status`.

  Then create and push a version tag to trigger the workflow:

  1. Create an annotated tag: `git tag -a v1.1.0 -m "Release v1.1.0"`
  2. Push the tag: `git push origin v1.1.0`
  3. Verify with: `git tag -l "v1.1.*"` and `git ls-remote --tags origin`

  IMPORTANT: The tag must be pushed AFTER the workflow file is on the remote branch. GitHub Actions only triggers on tags if the workflow file exists in the repository at the time of the tag push.

  If the user has not yet pushed to a remote or the remote is not configured, this becomes a blocker. Check with `git remote -v` first.
  </action>
  <verify>
  - `git log --oneline -3` shows the workflow commit
  - `git tag -l "v1.1.*"` shows v1.1.0
  - `git ls-remote --tags origin` shows v1.1.0 on remote
  - `gh run list --workflow=release.yml --limit=1` shows the triggered run (or check GitHub Actions tab)
  </verify>
  <done>Tag v1.1.0 is pushed to remote and the release workflow has been triggered on GitHub Actions.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
  Complete CI/CD release pipeline. A tag push (v1.1.0) should have triggered the GitHub Actions workflow which:
  1. Syncs version from tag to Cargo.toml
  2. Installs LLVM 18, Rust stable, Node.js LTS
  3. Runs all 151 cargo tests
  4. Builds the NSIS installer via tauri-action
  5. Creates a GitHub Release with installer attached
  6. Generates auto-release notes from commits
  7. Attaches SHA256 checksums file
  </what-built>
  <how-to-verify>
  1. Go to the GitHub repository Actions tab. Confirm the "Release" workflow was triggered by the v1.1.0 tag push.
  2. Wait for the workflow to complete (expect 15-25 minutes due to whisper.cpp compilation).
  3. If workflow FAILED: Click into the failed run, identify which step failed, and report the error. Common issues:
     - LIBCLANG_PATH not found -> install-llvm-action version issue
     - Tests failed -> pre-existing test issue
     - NSIS not found -> wrong bundle path
     - Permission denied -> missing contents: write permission
  4. If workflow SUCCEEDED: Go to the Releases page. Verify:
     - Release titled "Scribe 1.1.0" exists
     - NSIS installer (.exe file) is attached as an asset
     - SHA256SUMS.txt is attached as an asset
     - Release notes contain auto-generated commit changelog
  5. Download the installer and verify the SHA256 hash matches the checksums file.
  6. (Optional) Run the installer on your machine to confirm it works.

  Expected workflow duration: 15-25 minutes (whisper.cpp compiles fresh, ~15 min).
  Cached dependency builds should be faster on subsequent runs (~5 min savings).
  </how-to-verify>
  <resume-signal>Type "approved" if the release was created successfully, or describe any failures you see in the workflow run.</resume-signal>
</task>

</tasks>

<verification>
End-to-end pipeline verification:

1. GitHub Actions "Release" workflow triggered by v1.1.0 tag
2. Workflow completed with green status
3. GitHub Release "Scribe 1.1.0" exists
4. Release has NSIS installer (.exe) attached
5. Release has SHA256SUMS.txt attached
6. Release notes are auto-generated from commits
7. No manual steps were required after tag push
</verification>

<success_criteria>
- A single `git push origin v1.1.0` triggers the complete build-test-release pipeline
- GitHub Release is published automatically with installer and checksums
- All 5 CICD requirements validated in production
</success_criteria>

<output>
After completion, create `.planning/phases/06-cicd-pipeline/06-02-SUMMARY.md`
</output>
